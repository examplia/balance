<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typical Colors 2 - Weapon Rebalances</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Discord/Open Graph Meta Tags -->
    <meta property="og:title" content="Typical Colors 2 - Weapon Rebalances">
    <meta property="og:description" content="Community weapon rebalancing proposals to improve game balance and weapon viability across all classes. Featuring reworked stats, new mechanics, and quality of life improvements.">
    <meta property="og:image" content="images/TypicalColors2Rebalances-Icon-Header.png">
    <meta property="og:url" content="https://balance.typicalcolors.com">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Typical Colors 2">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Typical Colors 2 - Weapon Rebalances">
    <meta name="twitter:description" content="Community weapon rebalancing proposals to improve game balance and weapon viability across all classes.">
    <meta name="twitter:image" content="images/TypicalColors2Rebalances-Icon-Header.png">

    <!-- Additional Meta Tags -->
    <meta name="description" content="Typical Colors 2 weapon rebalance proposals for improved game balance, featuring reworked stats and new mechanics for all classes.">
    <meta name="keywords" content="TF2, Team Fortress 2, weapon rebalance, Typical Colors 2, game balance, weapon viability">
    <meta name="author" content="Typical Colors 2 Community">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="images/TypicalColors2Rebalances-Icon-Header.png">
    <link rel="apple-touch-icon" href="images/TypicalColors2Rebalances-Icon-Header.png">

    <!-- Theme Color for Mobile Browsers -->
    <meta name="theme-color" content="#4a2d5a">
    <meta name="msapplication-TileColor" content="#4a2d5a">

    <link rel="stylesheet" href="styles.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Creepster&family=Russo+One:wght@400&family=Anton:wght@400&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0a0615 0%, #120a20 50%, #0a0615 100%);
            color: #e8e0d8;
            font-family: 'Russo One', sans-serif;
            overflow-x: hidden;
        }
        
        .hero-section {
            position: relative;
            height: 100vh;
            background:
                radial-gradient(circle at 50% 30%, rgba(74, 45, 90, 0.5) 0%, transparent 50%),
                linear-gradient(180deg, rgba(10, 6, 21, 0.9) 0%, rgba(20, 10, 35, 0.95) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            text-align: center;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(74, 45, 90, 0.5) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(58, 29, 74, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(90, 61, 122, 0.3) 0%, transparent 50%),
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="smoke" patternUnits="userSpaceOnUse" width="100" height="100"><circle cx="20" cy="20" r="3" fill="%23ffffff" opacity="0.1"/><circle cx="80" cy="60" r="2" fill="%23ffffff" opacity="0.05"/><circle cx="40" cy="80" r="4" fill="%23ffffff" opacity="0.08"/><circle cx="60" cy="30" r="2" fill="%238261a5" opacity="0.03"/><circle cx="10" cy="70" r="3" fill="%236b46a3" opacity="0.04"/></pattern></defs><rect width="100" height="100" fill="url(%23smoke)"/></svg>');
            opacity: 0.7;
            animation: float 20s infinite linear, pulse 4s ease-in-out infinite alternate;
        }

        .hero-section::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                linear-gradient(45deg, transparent 30%, rgba(130, 97, 165, 0.15) 50%, transparent 70%),
                linear-gradient(-45deg, transparent 30%, rgba(107, 70, 163, 0.08) 50%, transparent 70%);
            animation: shimmer 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-100px); }
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            100% { opacity: 0.8; }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(0px) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .main-title {
            font-family: 'Anton', sans-serif;
            font-size: clamp(3rem, 8vw, 8rem);
            color: #4a2d5a;
            text-shadow:
                0 0 20px #4a2d5a,
                0 0 40px #3a1d4a,
                3px 3px 0px #120a20,
                6px 6px 0px #0a0615;
            margin-bottom: 1rem;
            letter-spacing: 3px;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 20px #4a2d5a, 0 0 40px #3a1d4a, 3px 3px 0px #120a20, 6px 6px 0px #0a0615; }
            to { text-shadow: 0 0 30px #5a3d7a, 0 0 60px #4a2d5a, 3px 3px 0px #120a20, 6px 6px 0px #0a0615; }
        }
        
        .subtitle {
            font-family: 'Creepster', cursive;
            font-size: clamp(1.5rem, 4vw, 3rem);
            color: #4a2d5a;
            text-shadow: 2px 2px 4px #000000;
            margin-bottom: 3rem;
            letter-spacing: 2px;
        }
        
        .update-info {
            background: rgba(0, 0, 0, 0.7);
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid #ff6600;
            max-width: 800px;
            margin: 0 auto;
            box-shadow: 0 0 30px rgba(255, 102, 0, 0.3);
        }
        
        .content-section {
            padding: 4rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .section-title {
            font-family: 'Anton', sans-serif;
            font-size: 3rem;
            color: white;
            text-align: center;
            margin-bottom: 3rem;
            text-shadow:
                2px 2px 4px #000000,
                0 0 20px rgba(128, 0, 128, 0.5),
                0 0 40px rgba(128, 0, 128, 0.3);
        }
        
        .weapon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 4rem;
        }
        
        .weapon-card {
            background:
                linear-gradient(145deg, rgba(74, 45, 90, 0.6), rgba(10, 6, 21, 0.98)),
                radial-gradient(circle at 30% 20%, rgba(58, 29, 74, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(74, 45, 90, 0.15) 0%, transparent 50%);
            border: 2px solid #4a2d5a;
            border-radius: 15px;
            padding: 2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow:
                0 8px 32px rgba(74, 45, 90, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
        }

        .weapon-card.selected {
            border-color: #7a5a9b;
            box-shadow:
                0 8px 32px rgba(122, 90, 155, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .compare-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(90, 61, 122, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            opacity: 0.7;
            box-shadow: 0 0 10px rgba(90, 61, 122, 0.6);
        }

        .compare-button:hover {
            background: rgba(90, 61, 122, 1);
            transform: scale(1.1);
            opacity: 1;
            box-shadow: 0 0 15px rgba(90, 61, 122, 0.8);
        }

        .compare-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(10, 6, 21, 0.98);
            padding: 1rem;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            border-top: 2px solid #5a3d7a;
            box-shadow: 0 0 30px rgba(90, 61, 122, 0.4);
        }

        .compare-panel.active {
            transform: translateY(0);
        }

        .compare-weapons {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 0.5rem;
        }
        
        .weapon-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .weapon-card:hover::before {
            left: 100%;
        }
        
        .weapon-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow:
                0 20px 60px rgba(74, 45, 90, 0.7),
                0 0 30px rgba(58, 29, 74, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            border-color: #4a2d5a;
            background:
                linear-gradient(145deg, rgba(74, 45, 90, 0.7), rgba(10, 6, 21, 0.99)),
                radial-gradient(circle at 30% 20%, rgba(74, 45, 90, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(58, 29, 74, 0.3) 0%, transparent 50%);
        }
        
        .weapon-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .weapon-icon {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #4a2d5a, #3a1d4a);
            border-radius: 50%;
            margin-right: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            text-shadow: 1px 1px 2px #000;
            will-change: transform;
            overflow: hidden;
            position: relative;
            box-shadow: 0 0 20px rgba(74, 45, 90, 0.7);
        }

        .weapon-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .weapon-icon img:hover {
            transform: scale(1.1);
        }

        .weapon-icon .fallback-icon {
            font-size: 2rem;
            color: white;
            text-shadow: 1px 1px 2px #000;
        }
        
        .weapon-info h3 {
            color: #f8d100;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 1px 1px 2px #000;
        }
        
        .weapon-class {
            color: #4a2d5a;
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .stat-positive {
            color: #9acdff;
            text-shadow: 0 0 5px #9acdff;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .stat-positive:hover {
            color: #b8e0ff;
            text-shadow: 0 0 10px #9acdff, 0 0 20px #9acdff;
            transform: scale(1.05);
        }

        .stat-negative {
            color: #fe3e3e;
            text-shadow: 0 0 5px #fe3e3e;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .stat-negative:hover {
            color: #ff6b6b;
            text-shadow: 0 0 10px #fe3e3e, 0 0 20px #fe3e3e;
            transform: scale(1.05);
        }

        .stat-change {
            color: #9acdff;
            font-weight: bold;
            text-shadow: 0 0 5px #9acdff;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .stat-change:hover {
            color: #b8e0ff;
            text-shadow: 0 0 10px #9acdff, 0 0 20px #9acdff;
            transform: scale(1.05);
        }

        .stat-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.5rem;
            border-radius: 5px;
            font-size: 0.8rem;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            pointer-events: none;
            white-space: nowrap;
        }

        .stat-positive:hover .stat-tooltip,
        .stat-negative:hover .stat-tooltip,
        .stat-change:hover .stat-tooltip {
            opacity: 1;
            visibility: visible;
        }
        
        .changes-section {
            background: rgba(130, 97, 165, 0.1);
            border-left: 4px solid #8261a5;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0 10px 10px 0;
        }
        
        
        .reason-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 3px solid #9acdff;
        }
        
        .class-divider {
            text-align: center;
            margin: 4rem 0;
            position: relative;
        }
        
        .class-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #4a2d5a, transparent);
            box-shadow: 0 0 10px rgba(74, 45, 90, 0.7);
        }
        
        .class-name {
            background:
                linear-gradient(135deg, #0a0615, #0f0a1a),
                radial-gradient(circle at 30% 30%, rgba(74, 45, 90, 0.6) 0%, transparent 70%);
            color: #4a2d5a;
            padding: 1rem 2rem;
            border-radius: 25px;
            border: 2px solid #4a2d5a;
            font-size: 2rem;
            font-family: 'Anton', sans-serif;
            display: inline-block;
            text-shadow:
                2px 2px 4px #000,
                0 0 20px rgba(74, 45, 90, 0.8);
            position: relative;
            z-index: 1;
            box-shadow: 0 0 30px rgba(74, 45, 90, 0.6);
        }
        
        .scroll-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(90, 61, 122, 0.8);
            color: white;
            padding: 1rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(90, 61, 122, 0.6);
        }

        .scroll-indicator:hover {
            background: rgba(90, 61, 122, 1);
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(90, 61, 122, 0.8);
        }
        
        @media (max-width: 768px) {
            .weapon-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .hero-section {
                padding: 2rem 1rem;
                height: auto;
                min-height: 80vh;
            }

            .main-title {
                font-size: clamp(2rem, 10vw, 6rem);
            }

            .subtitle {
                font-size: clamp(1rem, 6vw, 2rem);
            }

            .weapon-card {
                padding: 1.5rem;
                margin: 0 0.5rem;
            }

            .class-name {
                font-size: 1.5rem;
                padding: 0.8rem 1.5rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .scroll-indicator {
                bottom: 1rem;
                right: 1rem;
                padding: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .hero-section {
                padding: 1rem 0.5rem;
            }

            .weapon-card {
                padding: 1rem;
                margin: 0 0.25rem;
            }

            .weapon-header {
                flex-direction: column;
                text-align: center;
            }

            .weapon-icon {
                margin-bottom: 0.5rem;
                margin-right: 0;
            }

            .update-info {
                padding: 1.5rem;
                margin: 1rem auto;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Menu -->
    <nav class="main-navigation">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="images/TypicalColors2Rebalances-Icon-Header.png" alt="TC2 Logo" style="height: 40px;">
            </div>
            <div class="nav-links">
                <a href="#home" class="nav-link">Home</a>
                <a href="#workshop" class="nav-link">Workshop Items</a>
                <a href="#rebalances" class="nav-link">Weapon Rebalances</a>
                <a href="#concepts" class="nav-link">Weapon Ideas</a>
            </div>
            <div class="nav-discord">
                <a href="https://discord.gg/9TDY9P2cmG" target="_blank" class="nav-discord-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/>
                    </svg>
                    Join Discord
                </a>
            </div>
        </div>
    </nav>

    <!-- Changelog Section (moved to top) -->
    <section id="changelog" class="changelog-section">
        <div class="content-section">
            <h2 class="section-title">📋 Update Highlights</h2>
            <div class="changelog-grid">
                <div class="changelog-item">
                    <h3>🔄 Major Rebalances</h3>
                    <ul>
                        <li>• Flanker weapons: Improved mobility and sustain</li>
                        <li>• Trooper weapons: Enhanced projectile performance</li>
                        <li>• Arsonist weapons: Better afterburn mechanics</li>
                        <li>• Brute weapons: Balanced damage and mobility</li>
                    </ul>
                </div>
                <div class="changelog-item">
                    <h3>⚡ Quality of Life</h3>
                    <ul>
                        <li>• Faster reload times on key weapons</li>
                        <li>• Improved weapon switching speeds</li>
                        <li>• Better visual feedback and effects</li>
                        <li>• Enhanced weapon descriptions</li>
                    </ul>
                </div>
                <div class="changelog-item">
                    <h3>🎯 Balance Adjustments</h3>
                    <ul>
                        <li>• Reduced overpowered mechanics</li>
                        <li>• Buffed underperforming weapons</li>
                        <li>• Improved counterplay opportunities</li>
                        <li>• Enhanced team composition variety</li>
                    </ul>
                </div>
            </div>

            <div class="changelog-summary">
                <h3>📋 Key Changes Summary</h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <h4>Buffs</h4>
                        <p>Increased damage, faster firing speeds, better mobility, improved healing</p>
                    </div>
                    <div class="summary-item">
                        <h4>Nerfs</h4>
                        <p>Reduced clip sizes, slower reloads, decreased damage, limited mobility</p>
                    </div>
                    <div class="summary-item">
                        <h4>Tweaks</h4>
                        <p>Quality of life improvements, visual enhancements, mechanic refinements</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Home Section -->
    <section id="home" class="home-section">
        <div class="hero-section">
            <div style="text-align: center; margin-bottom: 2rem;">
                <img src="images/TypicalColors2Rebalances-Icon-Header.png" alt="Typical Colors 2 Header" style="max-width: 80%; height: auto; filter: drop-shadow(0 0 20px rgba(90, 61, 122, 0.5));">
            </div>

            <div class="update-info">
                <p style="font-size: 1.2rem; margin-bottom: 1rem;">Community weapon rebalancing proposals to improve game balance and weapon viability across all classes.</p>
                <p style="color: #4a2d5a;">Featuring reworked stats, new mechanics, and quality of life improvements</p>
                <p style="color: #f8d100; font-size: 0.9rem; margin-top: 1rem; font-style: italic; border-top: 1px solid rgba(248, 209, 0, 0.3); padding-top: 0.5rem;">
                    ⚠️ <strong>Disclaimer:</strong> This is an unofficial fan-made rebalance site created for entertainment and discussion purposes only. We are not affiliated with Dorcus or Typical Colors in any way. We do not expect or want these changes to be officially implemented, and we do not seek acknowledgment from the developers. This is purely for fun and community discussion.
                </p>
            </div>
        </div>

        <!-- Featured Content -->
        <div class="content-section">
            <div class="featured-grid">
                <div class="featured-item">
                    <h3>🎨 Featured Cosmetics</h3>
                    <p>Check out the latest cosmetic reskins and weapon appearances</p>
                    <a href="#workshop" class="featured-link">View Workshop Items →</a>
                </div>
                <div class="featured-item">
                    <h3>🗺️ Map Updates</h3>
                    <p>Suggested map reworks and new gameplay areas</p>
                    <span class="coming-soon">Coming Soon</span>
                </div>
                <div class="featured-item">
                    <h3>⚖️ Balance Changes</h3>
                    <p>Latest weapon rebalances and gameplay improvements</p>
                    <a href="#rebalances" class="featured-link">View Rebalances →</a>
                </div>
                <div class="featured-item">
                    <h3>💡 New Ideas</h3>
                    <p>Innovative weapon concepts and experimental features</p>
                    <a href="#concepts" class="featured-link">Explore Ideas →</a>
                </div>
            </div>

            <!-- Q&A Section -->
            <div class="qa-section">
                <h3>❓ Frequently Asked Questions</h3>
                <div class="qa-grid">
                    <div class="qa-item">
                        <h4>Are these changes official?</h4>
                        <p>No, these are community proposals for discussion and entertainment only.</p>
                    </div>
                    <div class="qa-item">
                        <h4>Can I suggest changes?</h4>
                        <p>Absolutely! Join our Discord to share your ideas and feedback.</p>
                    </div>
                    <div class="qa-item">
                        <h4>How are weapons balanced?</h4>
                        <p>We focus on improving viability, counterplay, and overall game health.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--
    CUSTOMIZABLE BANNER - Easy to modify!
    To change the banner content:
    1. Edit the banner-icon emoji/text
    2. Change the h3 title text
    3. Modify the p description text
    4. Update colors in styles.css under .custom-banner
    5. To hide permanently, change style.display='none' to style.display='block'
    -->
    <div class="custom-banner">
        <div class="banner-content">
            <div class="banner-icon">🚧</div>
            <div class="banner-text">
                <h3>Site Under Heavy Construction</h3>
                <p>This weapon rebalance site is currently undergoing major updates and improvements. Some features may be incomplete or subject to change. Thank you for your patience!</p>
            </div>
            <div class="banner-close" onclick="document.querySelector('.custom-banner').style.display='none'; document.body.style.paddingTop='0'; if(window.innerWidth <= 768) { document.body.style.paddingTop='0'; }">✕</div>
        </div>
    </div>

    <!-- Workshop Items Section -->
    <section id="workshop" class="workshop-section">
        <div class="content-section">
            <h2 class="section-title">🎨 Workshop Items</h2>
            <p class="section-description">Discover the latest cosmetics, reskins, and taunts from our community workshop</p>

            <div class="workshop-grid">
                <!-- Workshop items will be loaded here -->
                <div class="workshop-placeholder">
                    <h3>Coming Soon</h3>
                    <p>Workshop items and cosmetics are being prepared for display</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Weapon Rebalances Section -->
    <section id="rebalances" class="rebalances-section">
        <div class="content-section">
            <h2 class="section-title">⚖️ Weapon Rebalances</h2>
            <p class="section-description">Comprehensive weapon rebalancing proposals to improve game balance and viability</p>

            <!-- Search and Filter Controls -->
            <div class="search-filter-section">
                <div style="display: inline-flex; gap: 1rem; align-items: center; flex-wrap: wrap; justify-content: center;">
                    <input type="text" id="weaponSearch" placeholder="Search weapons..." style="padding: 0.5rem; border: 2px solid #5a3d7a; border-radius: 25px; background: rgba(10, 6, 21, 0.95); color: white; min-width: 200px; box-shadow: 0 0 10px rgba(90, 61, 122, 0.4);">
                    <select id="classFilter" style="padding: 0.5rem; border: 2px solid #5a3d7a; border-radius: 10px; background: rgba(10, 6, 21, 0.95); color: white; box-shadow: 0 0 10px rgba(90, 61, 122, 0.4);">
                        <option value="">All Classes</option>
                        <option value="flanker">Flanker</option>
                        <option value="trooper">Trooper</option>
                        <option value="arsonist">Arsonist</option>
                        <option value="annihilator">Annihilator</option>
                        <option value="mechanic">Mechanic</option>
                        <option value="doctor">Doctor</option>
                        <option value="marksman">Marksman</option>
                        <option value="brute">Brute</option>
                        <option value="agent">Agent</option>
                    </select>
                    <select id="typeFilter" style="padding: 0.5rem; border: 2px solid #5a3d7a; border-radius: 10px; background: rgba(10, 6, 21, 0.95); color: white; box-shadow: 0 0 10px rgba(90, 61, 122, 0.4);">
                        <option value="">All Types</option>
                        <option value="primary">Primary</option>
                        <option value="secondary">Secondary</option>
                        <option value="melee">Melee</option>
                        <option value="building">Building</option>
                    </select>
                </div>
            </div>

            <!-- Flanker Section -->
            <div class="class-divider">
                <div class="class-name">
                    FLANKER <img src="images/Flanker-Icon.png" alt="Flanker Icon">
                </div>
            </div>
            <div class="weapon-grid" id="flanker-weapons"><!-- Flanker weapons --></div>

            <!-- Trooper Section -->
            <div class="class-divider">
                <div class="class-name">
                    TROOPER <img src="images/Trooper-Icon.png" alt="Trooper Icon">
                </div>
            </div>
            <div class="weapon-grid" id="trooper-weapons"><!-- Trooper weapons --></div>

            <!-- Arsonist Section -->
            <div class="class-divider">
                <div class="class-name">
                    ARSONIST <img src="images/Arsonist-Icon.png" alt="Arsonist Icon">
                </div>
            </div>
            <div class="weapon-grid" id="arsonist-weapons"><!-- Arsonist weapons --></div>

            <!-- Brute Section -->
            <div class="class-divider">
                <div class="class-name">
                    BRUTE <img src="images/Brute-Icon.png" alt="Brute Icon">
                </div>
            </div>
            <div class="weapon-grid" id="brute-weapons"><!-- Brute weapons --></div>

            <!-- Mechanic Section -->
            <div class="class-divider">
                <div class="class-name">
                    MECHANIC <img src="images/MechanicIcon.png" alt="Mechanic Icon">
                </div>
            </div>
            <div class="weapon-grid" id="mechanic-weapons"><!-- Mechanic weapons --></div>

            <!-- Doctor Section -->
            <div class="class-divider">
                <div class="class-name">
                    DOCTOR <img src="images/Doctor-Icon.png" alt="Doctor Icon">
                </div>
            </div>
            <div class="weapon-grid" id="doctor-weapons"><!-- Doctor weapons --></div>

            <!-- Marksman Section -->
            <div class="class-divider">
                <div class="class-name">
                    MARKSMAN <img src="images/MarksmanIcon.png" alt="Marksman Icon">
                </div>
            </div>
            <div class="weapon-grid" id="marksman-weapons"><!-- Marksman weapons --></div>

            <!-- Annihilator Section -->
            <div class="class-divider">
                <div class="class-name">
                    ANNIHILATOR
                </div>
            </div>
            <div class="weapon-grid" id="annihilator-weapons"><!-- Annihilator weapons --></div>
        </div>
    </section>

    <!-- Weapon Ideas Section -->
    <section id="concepts" class="concepts-section">
        <div class="content-section">
            <div class="concept-header-section">
                <div class="concept-header-content">
                    <img src="images/NewWeaponConcepts-Icon-Header.png" alt="Weapon Ideas Header" class="concept-header-image">
                    <div class="concept-header-text">
                        <h2>💡 Weapon Ideas</h2>
                        <p>Innovative weapon concepts pushing the boundaries of gameplay</p>
                    </div>
                </div>
            </div>

            <div class="weapon-grid" id="concept-weapons">
                <!-- Concept weapons will be loaded here -->
            </div>
        </div>
    </section>

    <div class="scroll-indicator" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
        ↑
    </div>

    <div class="compare-panel" id="comparePanel">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h3 style="color: #4a2d5a; margin: 0;">Weapon Comparison</h3>
            <button onclick="clearComparison()" style="background: #fe3e3e; color: white; border: none; padding: 0.5rem; border-radius: 5px; cursor: pointer;">Clear</button>
        </div>
        <div class="compare-weapons" id="compareWeapons"></div>
    </div>

    <script>
        // Performance optimization: Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Function to create a weapon card
        function createWeaponCard(weapon) {
            // Create the weapon card element
            const card = document.createElement('div');
            card.className = 'weapon-card';
            // Add data-weapon attribute for comparison functionality
            card.setAttribute('data-weapon', weapon.name.toLowerCase().replace(/\s+/g, '-'));
            if (weapon.isConcept) {
                card.setAttribute('data-concept', 'true');
            }

            // Create the weapon header
            const header = document.createElement('div');
            header.className = 'weapon-header';

            // Create the weapon icon
            const icon = document.createElement('div');
            icon.className = 'weapon-icon';
            
            // Add image if available
            if (weapon.image) {
                const img = document.createElement('img');
                img.src = weapon.image;
                img.alt = weapon.name;
                img.loading = 'lazy';
                img.onerror = function() {
                    this.style.display = 'none';
                    this.nextElementSibling.style.display = 'block';
                };
                icon.appendChild(img);
                
                // Add fallback icon
                const fallbackIcon = document.createElement('div');
                fallbackIcon.className = 'fallback-icon';
                fallbackIcon.style.display = 'none';
                fallbackIcon.textContent = '🔫'; // Default fallback icon
                icon.appendChild(fallbackIcon);
            } else {
                // Use a default icon if no image is available
                icon.textContent = '🔫';
            }
            
            // Create the weapon info
            const info = document.createElement('div');
            info.className = 'weapon-info';
            
            // Create the weapon name
            const name = document.createElement('h3');
            name.textContent = weapon.name;
            
            // Create the weapon class
            const weaponClass = document.createElement('div');
            weaponClass.className = 'weapon-class';
            weaponClass.textContent = `${weapon.class} ${weapon.type}`;
            
            // Add name and class to info
            info.appendChild(name);
            info.appendChild(weaponClass);
            
            // Add icon and info to header
            header.appendChild(icon);
            header.appendChild(info);
            
            // Add header to card
            card.appendChild(header);
            
            // Create stats grid
            const statsGrid = document.createElement('div');
            statsGrid.className = 'stats-grid';
            
            // Create positive stats column
            const positiveCol = document.createElement('div');
            weapon.stats.positive.forEach(stat => {
                const statElement = document.createElement('div');
                statElement.className = 'stat-positive';
                statElement.textContent = stat;
                positiveCol.appendChild(statElement);
            });
            
            // Create negative stats column
            const negativeCol = document.createElement('div');
            weapon.stats.negative.forEach(stat => {
                const statElement = document.createElement('div');
                statElement.className = 'stat-negative';
                statElement.textContent = stat;
                negativeCol.appendChild(statElement);
            });
            
            // Add columns to stats grid
            statsGrid.appendChild(positiveCol);
            statsGrid.appendChild(negativeCol);
            
            // Add stats grid to card
            card.appendChild(statsGrid);
            
            // Create changes section if there are changes
            if (weapon.changes && weapon.changes.length > 0) {
                const changesSection = document.createElement('div');
                changesSection.className = 'changes-section';

                const changesTitle = document.createElement('div');
                changesTitle.className = 'changes-title';
                changesTitle.textContent = 'Changes';
                changesSection.appendChild(changesTitle);

                weapon.changes.forEach(change => {
                    const changeElement = document.createElement('div');
                    // Determine if change is positive or negative based on the text
                    const lowerChange = change.toLowerCase();

                    // Negative indicators
                    const negativeIndicators = [
                        'removed', 'nerfed', 'decreased', 'reduced', 'lowered', 'worse',
                        'penalty', 'damage penalty', 'slower', 'weaker', 'less'
                    ];

                    // Positive indicators
                    const positiveIndicators = [
                        'added', 'buffed', 'increased', 'faster', 'stronger', 'better',
                        'bonus', 'more', 'improved', 'enhanced'
                    ];

                    // Check for negative indicators first
                    const hasNegative = negativeIndicators.some(indicator => lowerChange.includes(indicator));
                    const hasPositive = positiveIndicators.some(indicator => lowerChange.includes(indicator));

                    // Special cases for misleading positive words
                    const isMisleadingPositive = (
                        (lowerChange.includes('increased') || lowerChange.includes('more')) &&
                        (lowerChange.includes('penalty') || lowerChange.includes('damage penalty') ||
                         lowerChange.includes('cooldown') || lowerChange.includes('slower'))
                    );

                    if (hasNegative || isMisleadingPositive) {
                        changeElement.className = 'stat-negative';
                    } else if (hasPositive || change.includes('+')) {
                        changeElement.className = 'stat-positive';
                    } else {
                        changeElement.className = 'stat-positive'; // Default to positive for neutral changes
                    }

                    changeElement.textContent = change;
                    changesSection.appendChild(changeElement);
                });

                card.appendChild(changesSection);
            }
            
            // Create reasoning section
            const reasonSection = document.createElement('div');
            reasonSection.className = 'reason-section';
            
            const reasonTitle = document.createElement('strong');
            reasonTitle.textContent = weapon.isConcept ? 'Concept:' : 'Reasoning:';
            reasonSection.appendChild(reasonTitle);

            const reasonText = document.createElement('span');
            // For concept weapons, show the changes as conceptual description
            if (weapon.isConcept) {
                if (weapon.changes && weapon.changes.length > 0 && weapon.changes[0] !== "") {
                    reasonText.textContent = ' ' + weapon.changes.join(' ');
                } else if (weapon.reasoning && weapon.reasoning.trim() !== "") {
                    reasonText.textContent = ' ' + weapon.reasoning;
                } else {
                    reasonText.textContent = ' This is a conceptual weapon idea for future development.';
                }
            } else {
                reasonText.textContent = ' ' + weapon.reasoning;
            }
            reasonSection.appendChild(reasonText);
            
            card.appendChild(reasonSection);
            
            return card;
        }

        // Function to load weapons from JSON
        async function loadWeapons() {
            try {
                const response = await fetch('weapons.json');
                const data = await response.json();

                // Group weapons by class
                const weaponsByClass = {};
                data.weapons.forEach(weapon => {
                    // Map class names to TC2 nomenclature
                    let className = weapon.class;
                    if (className === 'Soldier') className = 'Trooper';
                    if (className === 'Pyro') className = 'Arsonist';
                    if (className === 'Engineer') className = 'Mechanic';
                    if (className === 'Demoman') className = 'Annihilator';
                    if (className === 'Medic') className = 'Doctor';
                    if (className === 'Sniper') className = 'Marksman';
                    if (className === 'Heavy') className = 'Brute';
                    if (className === 'Scout') className = 'Flanker';
                    if (className === 'Spy') className = 'Agent';

                    if (!weaponsByClass[className]) {
                        weaponsByClass[className] = [];
                    }
                    weaponsByClass[className].push(weapon);
                });

                // Create weapon cards for each class
                for (const [className, weapons] of Object.entries(weaponsByClass)) {
                    const containerId = className.toLowerCase() + '-weapons';
                    const container = document.getElementById(containerId);

                    if (container) {
                        // Create weapon cards
                        weapons.forEach(weapon => {
                            const card = createWeaponCard(weapon);
                            container.appendChild(card);
                        });
                    }
                }

                // Load concept weapons
                const conceptWeapons = data.weapons.filter(weapon => weapon.isConcept);
                const conceptContainer = document.getElementById('concept-weapons');
                conceptWeapons.forEach(weapon => {
                    const card = createWeaponCard(weapon);
                    conceptContainer.appendChild(card);
                });

                // Re-initialize animations and effects for new content
                setTimeout(initializeAnimations, 0);
            } catch (error) {
                console.error('Error loading weapons:', error);
            }
        }

        // Enhanced function to initialize animations and effects with error handling
        function initializeAnimations(retryCount = 0) {
            const maxRetries = 3;
            console.log(`[SEARCH-DEBUG] Initializing animations (attempt ${retryCount + 1}/${maxRetries})`);

            try {
                // Check for required DOM elements
                if (!document || !document.querySelectorAll) {
                    throw new Error('DOM not ready for animation initialization');
                }

                // Smooth scrolling for all internal links
                const cards = document.querySelectorAll('.weapon-card');
                const classDividers = document.querySelectorAll('.class-divider');

                console.log(`[SEARCH-DEBUG] Found ${cards.length} weapon cards and ${classDividers.length} class dividers`);

                if (cards.length === 0) {
                    console.warn('[SEARCH-DEBUG] No weapon cards found for animation initialization');
                    if (retryCount < maxRetries) {
                        console.log(`[SEARCH-DEBUG] Retrying animation initialization in 100ms...`);
                        setTimeout(() => initializeAnimations(retryCount + 1), 100);
                        return;
                    } else {
                        console.error('[SEARCH-DEBUG] Max retries reached for animation initialization');
                        return;
                    }
                }

                // Add subtle animation on scroll
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach((entry, index) => {
                        if (entry.isIntersecting) {
                            setTimeout(() => {
                                try {
                                    entry.target.style.opacity = '1';
                                    entry.target.style.transform = 'translateY(0)';
                                } catch (styleError) {
                                    console.error('[SEARCH-DEBUG] Error applying scroll animation styles:', styleError);
                                }
                            }, index * 100);
                        }
                    });
                }, { threshold: 0.1 });

                // Initialize card animations
                let cardsInitialized = 0;
                cards.forEach((card, index) => {
                    try {
                        if (!card) {
                            console.warn(`[SEARCH-DEBUG] Null card at index ${index}`);
                            return;
                        }

                        card.style.opacity = '0';
                        card.style.transform = 'translateY(30px)';
                        card.style.transition = 'opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), transform 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
                        observer.observe(card);
                        cardsInitialized++;
                    } catch (cardError) {
                        console.error(`[SEARCH-DEBUG] Error initializing card ${index}:`, cardError);
                    }
                });

                // Initialize class divider animations
                let dividersInitialized = 0;
                classDividers.forEach((divider, index) => {
                    try {
                        if (!divider) {
                            console.warn(`[SEARCH-DEBUG] Null divider at index ${index}`);
                            return;
                        }

                        divider.style.opacity = '0';
                        divider.style.transform = 'scale(0.9)';
                        divider.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                        observer.observe(divider);
                        dividersInitialized++;
                    } catch (dividerError) {
                        console.error(`[SEARCH-DEBUG] Error initializing divider ${index}:`, dividerError);
                    }
                });

                console.log(`[SEARCH-DEBUG] Initialized ${cardsInitialized} cards and ${dividersInitialized} dividers`);

                // Add weapon card click effects with verification
                let clickListenersAdded = 0;
                cards.forEach((card, index) => {
                    try {
                        if (!card) {
                            console.warn(`[SEARCH-DEBUG] Cannot add click listener to null card at index ${index}`);
                            return;
                        }

                        // Remove existing listeners to prevent duplicates
                        const newCard = card.cloneNode(true);
                        if (card.parentNode) {
                            card.parentNode.replaceChild(newCard, card);
                        }

                        // Add click effect
                        newCard.addEventListener('click', function() {
                            try {
                                this.style.transform = 'scale(0.98)';
                                setTimeout(() => {
                                    try {
                                        this.style.transform = '';
                                    } catch (resetError) {
                                        console.error('[SEARCH-DEBUG] Error resetting click transform:', resetError);
                                    }
                                }, 150);
                            } catch (clickError) {
                                console.error('[SEARCH-DEBUG] Error in click handler:', clickError);
                            }
                        });

                        clickListenersAdded++;
                    } catch (listenerError) {
                        console.error(`[SEARCH-DEBUG] Error adding click listener to card ${index}:`, listenerError);
                    }
                });

                console.log(`[SEARCH-DEBUG] Added click listeners to ${clickListenersAdded} cards`);
                console.log(`[SEARCH-DEBUG] Animation initialization completed successfully`);

            } catch (error) {
                console.error('[SEARCH-DEBUG] Error in initializeAnimations:', error);
                console.error('[SEARCH-DEBUG] Stack trace:', error.stack);

                if (retryCount < maxRetries) {
                    console.log(`[SEARCH-DEBUG] Retrying animation initialization in 200ms...`);
                    setTimeout(() => initializeAnimations(retryCount + 1), 200);
                } else {
                    console.error('[SEARCH-DEBUG] Max retries reached for animation initialization');
                }
            }
        }

        // Navigation functionality
        function initializeNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');

            // Smooth scrolling for navigation links
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetSection = document.querySelector(targetId);

                    if (targetSection) {
                        const offsetTop = targetSection.offsetTop - 60; // Account for fixed nav
                        window.scrollTo({
                            top: offsetTop,
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Update active navigation link on scroll
            function updateActiveNavLink() {
                const sections = document.querySelectorAll('section[id]');
                const scrollPosition = window.scrollY + 100;

                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.offsetHeight;
                    const sectionId = section.getAttribute('id');

                    if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${sectionId}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }

            window.addEventListener('scroll', updateActiveNavLink);
            updateActiveNavLink(); // Initial call
        }

        // Add some interactive effects
        document.addEventListener('DOMContentLoaded', function() {
            // Load weapons from JSON
            loadWeapons();

            // Initialize navigation
            initializeNavigation();

            // Add particle effect to hero section
            createParticles();

            // Add scroll-based parallax effect
            window.addEventListener('scroll', function() {
                const scrolled = window.pageYOffset;
                const hero = document.querySelector('.hero-section');
                if (hero) {
                    hero.style.backgroundPosition = `50% ${scrolled * 0.5}px`;
                }
            });

            // Initialize comparison system
            window.selectedWeapons = [];

            // Initialize search and filter
            const searchInput = document.getElementById('weaponSearch');
            const classFilter = document.getElementById('classFilter');
            const typeFilter = document.getElementById('typeFilter');

            function filterWeapons(retryCount = 0) {
                const maxRetries = 3;
                const startTime = performance.now();

                console.log(`[SEARCH-DEBUG] ===== STARTING WEAPON FILTER (attempt ${retryCount + 1}/${maxRetries}) =====`);
                console.log(`[SEARCH-DEBUG] Timestamp: ${new Date().toISOString()}`);

                try {
                    // Validate input elements
                    if (!searchInput || !classFilter || !typeFilter) {
                        throw new Error('Search input elements not found');
                    }

                    const searchTerm = searchInput.value ? searchInput.value.toLowerCase().trim() : '';
                    const selectedClass = classFilter.value ? classFilter.value.toLowerCase().trim() : '';
                    const selectedType = typeFilter.value ? typeFilter.value.toLowerCase().trim() : '';

                    console.log(`[SEARCH-DEBUG] Search parameters: term="${searchTerm}", class="${selectedClass}", type="${selectedType}"`);

                    // Validate search term
                    if (searchTerm && searchTerm.length > 100) {
                        console.warn('[SEARCH-DEBUG] Search term too long, truncating');
                        searchTerm = searchTerm.substring(0, 100);
                    }

                    // Get weapon cards with validation
                    const weaponCards = document.querySelectorAll('.weapon-card');
                    if (!weaponCards || weaponCards.length === 0) {
                        console.warn('[SEARCH-DEBUG] No weapon cards found in DOM');
                        if (retryCount < maxRetries) {
                            console.log(`[SEARCH-DEBUG] Retrying filter in 100ms...`);
                            setTimeout(() => filterWeapons(retryCount + 1), 100);
                            return;
                        } else {
                            console.error('[SEARCH-DEBUG] No weapon cards available after max retries');
                            return;
                        }
                    }

                    console.log(`[SEARCH-DEBUG] Found ${weaponCards.length} weapon cards to process`);

                    const visibleCards = [];
                    const hiddenCards = [];
                    let cardsProcessed = 0;
                    let cardsFiltered = 0;

                    // Process each weapon card
                    weaponCards.forEach((card, index) => {
                        try {
                            if (!card) {
                                console.warn(`[SEARCH-DEBUG] Null card at index ${index}`);
                                return;
                            }

                            // Extract weapon information with validation
                            const nameElement = card.querySelector('h3');
                            const classElement = card.querySelector('.weapon-class');

                            if (!nameElement || !classElement) {
                                console.warn(`[SEARCH-DEBUG] Missing required elements in card ${index}`);
                                return;
                            }

                            const weaponName = nameElement.textContent ? nameElement.textContent.toLowerCase().trim() : '';
                            const weaponClassText = classElement.textContent ? classElement.textContent.toLowerCase().trim() : '';

                            if (!weaponName || !weaponClassText) {
                                console.warn(`[SEARCH-DEBUG] Empty weapon data in card ${index}`);
                                return;
                            }

                            const weaponClassParts = weaponClassText.split(' ');
                            const weaponClass = weaponClassParts[0] || '';
                            const weaponType = weaponClassParts[1] || '';

                            // Perform filtering logic
                            const matchesSearch = !searchTerm || weaponName.includes(searchTerm);
                            const matchesClass = !selectedClass || weaponClass === selectedClass;
                            const matchesType = !selectedType || weaponType === selectedType;

                            if (matchesSearch && matchesClass && matchesType) {
                                // Calculate priority score for sorting
                                let priority = 0;

                                // Exact weapon name match gets highest priority
                                if (searchTerm && weaponName === searchTerm) {
                                    priority += 100;
                                }
                                // Weapon name contains search term
                                else if (searchTerm && weaponName.includes(searchTerm)) {
                                    priority += 50;
                                }

                                // Class match gets priority
                                if (selectedClass && weaponClass === selectedClass) {
                                    priority += 20;
                                }

                                // Type match gets priority
                                if (selectedType && weaponType === selectedType) {
                                    priority += 10;
                                }

                                card._priority = priority;
                                visibleCards.push(card);
                                cardsFiltered++;
                            } else {
                                hiddenCards.push(card);
                            }

                            cardsProcessed++;
                        } catch (cardError) {
                            console.error(`[SEARCH-DEBUG] Error processing card ${index}:`, cardError);
                        }
                    });

                    console.log(`[SEARCH-DEBUG] Processed ${cardsProcessed} cards, ${cardsFiltered} visible, ${hiddenCards.length} hidden`);

                    // Sort visible cards by priority (highest first)
                    visibleCards.sort((a, b) => (b._priority || 0) - (a._priority || 0));

                    // Get all weapon grid containers with validation
                    const allContainers = document.querySelectorAll('.weapon-grid');
                    if (!allContainers || allContainers.length === 0) {
                        throw new Error('No weapon grid containers found');
                    }

                    console.log(`[SEARCH-DEBUG] Found ${allContainers.length} weapon grid containers`);

                    // Clear all containers with error handling
                    let containersCleared = 0;
                    allContainers.forEach((container, index) => {
                        try {
                            if (!container) {
                                console.warn(`[SEARCH-DEBUG] Null container at index ${index}`);
                                return;
                            }
                            container.innerHTML = '';
                            containersCleared++;
                        } catch (clearError) {
                            console.error(`[SEARCH-DEBUG] Error clearing container ${index}:`, clearError);
                        }
                    });

                    console.log(`[SEARCH-DEBUG] Cleared ${containersCleared} containers`);

                    // Re-append cards to their appropriate containers
                    let cardsReappended = 0;
                    visibleCards.forEach((card, index) => {
                        try {
                            if (!card) {
                                console.warn(`[SEARCH-DEBUG] Cannot re-append null card at index ${index}`);
                                return;
                            }

                            // Check if this is a concept weapon
                            const isConcept = card.hasAttribute('data-concept');
                            let targetContainer = null;

                            if (isConcept) {
                                // Concept weapons go to the concept container
                                targetContainer = document.getElementById('concept-weapons');
                            } else {
                                // Find the appropriate container based on weapon class
                                const classElement = card.querySelector('.weapon-class');
                                if (!classElement || !classElement.textContent) {
                                    console.warn(`[SEARCH-DEBUG] Cannot determine container for card ${index}`);
                                    return;
                                }

                                const weaponClass = classElement.textContent.toLowerCase().split(' ')[0];

                                // Map class names to container IDs
                                const classMappings = {
                                    'flanker': 'flanker-weapons',
                                    'trooper': 'trooper-weapons',
                                    'arsonist': 'arsonist-weapons',
                                    'brute': 'brute-weapons',
                                    'mechanic': 'mechanic-weapons',
                                    'doctor': 'doctor-weapons',
                                    'marksman': 'marksman-weapons',
                                    'annihilator': 'annihilator-weapons'
                                };

                                const containerId = classMappings[weaponClass];
                                if (containerId) {
                                    targetContainer = document.getElementById(containerId);
                                }
                            }

                            if (targetContainer) {
                                card.style.display = 'block';
                                card.style.animation = 'fadeIn 0.5s ease';
                                targetContainer.appendChild(card);
                                cardsReappended++;
                            } else {
                                console.warn(`[SEARCH-DEBUG] No target container found for card ${index}`);
                            }
                        } catch (reappendError) {
                            console.error(`[SEARCH-DEBUG] Error re-appending card ${index}:`, reappendError);
                        }
                    });

                    console.log(`[SEARCH-DEBUG] Re-appended ${cardsReappended} cards`);

                    // Hide cards that don't match filters
                    let cardsHidden = 0;
                    hiddenCards.forEach((card, index) => {
                        try {
                            if (card && card.style) {
                                card.style.display = 'none';
                                cardsHidden++;
                            }
                        } catch (hideError) {
                            console.error(`[SEARCH-DEBUG] Error hiding card ${index}:`, hideError);
                        }
                    });

                    console.log(`[SEARCH-DEBUG] Hidden ${cardsHidden} cards`);

                    // Re-initialize animations and event listeners for moved cards
                    console.log(`[SEARCH-DEBUG] Triggering animation re-initialization...`);
                    setTimeout(() => {
                        try {
                            initializeAnimations();
                            const endTime = performance.now();
                            console.log(`[SEARCH-DEBUG] ===== FILTER COMPLETED SUCCESSFULLY in ${(endTime - startTime).toFixed(2)}ms =====`);
                        } catch (initError) {
                            console.error('[SEARCH-DEBUG] Error during animation initialization:', initError);
                            console.error('[SEARCH-DEBUG] Stack trace:', initError.stack);
                        }
                    }, 0);

                } catch (error) {
                    console.error('[SEARCH-DEBUG] ===== FILTER ERROR =====');
                    console.error('[SEARCH-DEBUG] Error in filterWeapons:', error);
                    console.error('[SEARCH-DEBUG] Stack trace:', error.stack);
                    console.error('[SEARCH-DEBUG] Search parameters at error:', {
                        searchTerm: searchInput ? searchInput.value : 'N/A',
                        selectedClass: classFilter ? classFilter.value : 'N/A',
                        selectedType: typeFilter ? typeFilter.value : 'N/A'
                    });

                    if (retryCount < maxRetries) {
                        console.log(`[SEARCH-DEBUG] Retrying filter in 300ms...`);
                        setTimeout(() => filterWeapons(retryCount + 1), 300);
                    } else {
                        console.error('[SEARCH-DEBUG] Max retries reached for filterWeapons');
                        console.error('[SEARCH-DEBUG] ===== FILTER FAILED PERMANENTLY =====');
                    }
                }
            }

            // Add event listeners with error handling
            try {
                if (searchInput) {
                    searchInput.addEventListener('input', debounce(filterWeapons, 300));
                    console.log('[SEARCH-DEBUG] Search input event listener added');
                } else {
                    console.error('[SEARCH-DEBUG] Search input element not found');
                }

                if (classFilter) {
                    classFilter.addEventListener('change', filterWeapons);
                    console.log('[SEARCH-DEBUG] Class filter event listener added');
                } else {
                    console.error('[SEARCH-DEBUG] Class filter element not found');
                }

                if (typeFilter) {
                    typeFilter.addEventListener('change', filterWeapons);
                    console.log('[SEARCH-DEBUG] Type filter event listener added');
                } else {
                    console.error('[SEARCH-DEBUG] Type filter element not found');
                }

                console.log('[SEARCH-DEBUG] All search event listeners initialized successfully');
            } catch (listenerError) {
                console.error('[SEARCH-DEBUG] Error setting up search event listeners:', listenerError);
                console.error('[SEARCH-DEBUG] Stack trace:', listenerError.stack);
            }

            // Add a debug function to test search functionality
            window.testSearchFunctionality = function() {
                console.log('[SEARCH-DEBUG] ===== TESTING SEARCH FUNCTIONALITY =====');
                console.log('[SEARCH-DEBUG] Search input value:', searchInput ? searchInput.value : 'N/A');
                console.log('[SEARCH-DEBUG] Class filter value:', classFilter ? classFilter.value : 'N/A');
                console.log('[SEARCH-DEBUG] Type filter value:', typeFilter ? typeFilter.value : 'N/A');

                const cards = document.querySelectorAll('.weapon-card');
                console.log('[SEARCH-DEBUG] Total weapon cards found:', cards.length);

                // Test filter function
                try {
                    filterWeapons();
                    console.log('[SEARCH-DEBUG] Filter function executed successfully');
                } catch (testError) {
                    console.error('[SEARCH-DEBUG] Error testing filter function:', testError);
                    console.error('[SEARCH-DEBUG] Stack trace:', testError.stack);
                }

                console.log('[SEARCH-DEBUG] ===== SEARCH TEST COMPLETED =====');
            };

            // Add keyboard shortcut for debugging (Ctrl+Shift+D)
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                    e.preventDefault();
                    console.log('[SEARCH-DEBUG] Debug shortcut activated');
                    window.testSearchFunctionality();
                }
            });
        });

        function toggleCompare(weaponId) {
            const card = document.querySelector(`[data-weapon="${weaponId}"]`);
            const index = window.selectedWeapons.indexOf(weaponId);

            if (index > -1) {
                // Remove from comparison
                window.selectedWeapons.splice(index, 1);
                card.classList.remove('selected');
            } else {
                // Add to comparison (max 3)
                if (window.selectedWeapons.length < 3) {
                    window.selectedWeapons.push(weaponId);
                    card.classList.add('selected');
                } else {
                    alert('You can compare up to 3 weapons at a time.');
                    return;
                }
            }

            updateComparePanel();
        }

        function updateComparePanel() {
            const panel = document.getElementById('comparePanel');
            const container = document.getElementById('compareWeapons');

            if (window.selectedWeapons.length > 0) {
                panel.classList.add('active');
                container.innerHTML = '';

                window.selectedWeapons.forEach(weaponId => {
                    const weaponCard = document.querySelector(`[data-weapon="${weaponId}"]`);
                    const weaponName = weaponCard.querySelector('h3').textContent;
                    const weaponClass = weaponCard.querySelector('.weapon-class').textContent;

                    const compareItem = document.createElement('div');
                    compareItem.style.cssText = `
                        background: rgba(90, 61, 122, 0.4);
                        box-shadow: 0 0 15px rgba(90, 61, 122, 0.3);
                        border: 1px solid #8261a5;
                        border-radius: 10px;
                        padding: 1rem;
                        min-width: 200px;
                        text-align: center;
                    `;
                    compareItem.innerHTML = `
                        <h4 style="color: #4a2d5a; margin: 0 0 0.5rem 0;">${weaponName}</h4>
                        <div style="color: #9acdff; font-size: 0.9rem;">${weaponClass}</div>
                        <button onclick="toggleCompare('${weaponId}')" style="background: #fe3e3e; color: white; border: none; padding: 0.3rem 0.6rem; border-radius: 3px; cursor: pointer; margin-top: 0.5rem; font-size: 0.8rem;">Remove</button>
                    `;
                    container.appendChild(compareItem);
                });
            } else {
                panel.classList.remove('active');
            }
        }

        function clearComparison() {
            window.selectedWeapons.forEach(weaponId => {
                const card = document.querySelector(`[data-weapon="${weaponId}"]`);
                if (card) card.classList.remove('selected');
            });
            window.selectedWeapons = [];
            updateComparePanel();
        }

        function createParticles() {
            const hero = document.querySelector('.hero-section');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.cssText = `
                    position: absolute;
                    width: ${Math.random() * 4 + 2}px;
                    height: ${Math.random() * 4 + 2}px;
                    background: radial-gradient(circle, rgba(74, 45, 90, ${Math.random() * 0.5 + 0.2}), transparent);
                    border-radius: 50%;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    animation: particleFloat ${Math.random() * 10 + 10}s infinite linear;
                    pointer-events: none;
                    box-shadow: 0 0 10px rgba(74, 45, 90, 0.4);
                `;
                hero.appendChild(particle);
            }
    // Debug logging for section titles
    document.addEventListener('DOMContentLoaded', function() {
        const titles = document.querySelectorAll('.section-title');
        titles.forEach((title, index) => {
            const computedStyle = window.getComputedStyle(title);
            console.log(`Section title ${index + 1} (${title.textContent.trim()}):`);
            console.log('Color:', computedStyle.color);
            console.log('Text Shadow:', computedStyle.textShadow);
            console.log('Background:', computedStyle.background);
            console.log('Webkit Text Fill Color:', computedStyle.webkitTextFillColor);
            console.log('---');
        });
    });
        }
    </script>
</body>
</html>